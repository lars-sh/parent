<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GlobalProxyConfiguration.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Utilities</a> &gt; <a href="index.source.html" class="el_package">de.larssh.utils.net</a> &gt; <span class="el_source">GlobalProxyConfiguration.java</span></div><h1>GlobalProxyConfiguration.java</h1><pre class="source lang-java linenums">// Generated by delombok at Wed Oct 01 07:40:21 UTC 2025
package de.larssh.utils.net;

import static java.util.Arrays.asList;
import java.net.InetSocketAddress;
import java.net.Proxy.Type;
import java.util.Collection;
import java.util.Collections;
import java.util.LinkedHashSet;
import java.util.Optional;
import java.util.Set;
import de.larssh.utils.Nullables;
import de.larssh.utils.text.SplitLimit;
import de.larssh.utils.text.Strings;

/**
 * Proxy related properties, described at &lt;a href=
 * &quot;https://docs.oracle.com/javase/8/docs/api/java/net/doc-files/net-properties.html&quot;&gt;Network
 * Properties&lt;/a&gt;.
 *
 * &lt;p&gt;
 * &lt;b&gt;Usage example 1:&lt;/b&gt; The following shows how to set a global HTTP proxy.
 *
 * &lt;pre&gt;
 * InetSocketAddress inetSocketAddress = new InetSocketAddress(&quot;proxy.example.com&quot;, &quot;8080&quot;);
 * GlobalProxyConfiguration.HTTP.setGlobalProxy(inetSocketAddress);
 * &lt;/pre&gt;
 *
 * &lt;p&gt;
 * &lt;b&gt;Usage example 2:&lt;/b&gt; The following shows how to unset the global HTTP
 * proxy.
 *
 * &lt;pre&gt;
 * GlobalProxyConfiguration.HTTP.unsetGlobalProxy();
 * &lt;/pre&gt;
 */
public class GlobalProxyConfiguration {
	/**
	 * Default {@code nonProxyHosts} for {@link #FTP} and {@link #HTTP}
	 */
<span class="nc" id="L41">	private static final Collection&lt;String&gt; NO_PROXY_HOSTS_DEFAULT = asList(&quot;localhost&quot;, &quot;127.*&quot;, &quot;[::1]&quot;);</span>
	/**
	 * FTP proxy related settings
	 */
<span class="nc" id="L45">	public static final GlobalProxyConfiguration FTP = new GlobalProxyConfiguration(&quot;FTP&quot;, Type.HTTP, 80, &quot;ftp.proxyHost&quot;, &quot;ftp.proxyPort&quot;, Optional.of(&quot;ftp.nonProxyHosts&quot;), Optional.of(NO_PROXY_HOSTS_DEFAULT));</span>
	/**
	 * HTTP proxy related settings
	 */
<span class="nc" id="L49">	public static final GlobalProxyConfiguration HTTP = new GlobalProxyConfiguration(&quot;HTTP&quot;, Type.HTTP, 80, &quot;http.proxyHost&quot;, &quot;http.proxyPort&quot;, Optional.of(&quot;http.nonProxyHosts&quot;), Optional.of(NO_PROXY_HOSTS_DEFAULT));</span>
	/**
	 * HTTPS proxy related settings
	 *
	 * &lt;p&gt;
	 * The HTTPS protocol handler will use the same {@code nonProxyHosts} property
	 * as the HTTP protocol. Use {@link #HTTP} to modify that property.
	 */
<span class="nc" id="L57">	public static final GlobalProxyConfiguration HTTPS = new GlobalProxyConfiguration(&quot;HTTPS&quot;, Type.HTTP, 443, &quot;https.proxyHost&quot;, &quot;https.proxyPort&quot;, Optional.empty(), Optional.empty());</span>
	/**
	 * SOCKS proxy related properties
	 *
	 * &lt;p&gt;
	 * The SOCKS protocol handler does not support the {@code nonProxyHosts}
	 * property.
	 */
<span class="nc" id="L65">	public static final GlobalProxyConfiguration SOCKS = new GlobalProxyConfiguration(&quot;SOCKS&quot;, Type.SOCKS, 1080, &quot;socksProxyHost&quot;, &quot;socksProxyPort&quot;, Optional.empty(), Optional.empty());</span>
	/**
	 * Name
	 */
	private final String name;
	/**
	 * Proxy type
	 */
	private final Type type;
	/**
	 * Default proxy port
	 */
	private final int defaultPort;
	/**
	 * Host property name
	 */
	private final String hostProperty;
	/**
	 * Port property name
	 */
	private final String portProperty;
	/**
	 * {@code nonProxyHosts} property name
	 */
	private final Optional&lt;String&gt; nonProxyHostsProperty;
	/**
	 * Default {@code nonProxyHosts}
	 */
	private final Optional&lt;Collection&lt;String&gt;&gt; defaultNonProxyHosts;

	/**
	 * Appends all of {@code nonProxyHosts} to the current protocols
	 * {@code nonProxyHosts} property if it is not already present.
	 *
	 * &lt;p&gt;
	 * For protocols not supporting the {@code nonProxyHosts} property an
	 * {@link UnsupportedOperationException} is thrown.
	 *
	 * @param nonProxyHosts any number of hosts that should be accessed
	 *                      &lt;b&gt;without&lt;/b&gt; going through the proxy
	 * @throws UnsupportedOperationException for protocols not supporting the
	 *                                       {@code nonProxyHosts} property
	 */
	public void addNonProxyHosts(final String... nonProxyHosts) {
<span class="nc" id="L109">		final Set&lt;String&gt; set = getNonProxyHosts();</span>
<span class="nc" id="L110">		set.addAll(asList(nonProxyHosts));</span>
<span class="nc" id="L111">		setNonProxyHosts(set);</span>
<span class="nc" id="L112">	}</span>

	/**
	 * Returns all patterns of the current protocols {@code nonProxyHosts} property.
	 *
	 * &lt;p&gt;
	 * For protocols not supporting the {@code nonProxyHosts} property an
	 * {@link UnsupportedOperationException} is thrown.
	 *
	 * @return patterns of the current protocols {@code nonProxyHosts} property
	 * @throws UnsupportedOperationException for protocols not supporting the
	 *                                       {@code nonProxyHosts} property
	 */
	public Set&lt;String&gt; getNonProxyHosts() {
<span class="nc" id="L126">		return new LinkedHashSet&lt;&gt;(asList(Nullables.orElse(System.getProperty(getNonProxyHostsPropertyOrThrow()), &quot;&quot;).split(&quot;\\|&quot;, SplitLimit.NO_LIMIT_AND_STRIP_EMPTY_TRAILING)));</span>
	}

	/**
	 * Returns the current protocols {@code nonProxyHosts} property name.
	 *
	 * &lt;p&gt;
	 * For protocols not supporting the {@code nonProxyHosts} property an
	 * {@link UnsupportedOperationException} is thrown.
	 *
	 * @return the current protocols {@code nonProxyHosts} property name
	 * @throws UnsupportedOperationException for protocols not supporting the
	 *                                       {@code nonProxyHosts} property
	 */
	protected String getNonProxyHostsPropertyOrThrow() {
<span class="nc" id="L141">		return getNonProxyHostsProperty().orElseThrow(() -&gt; new UnsupportedOperationException(Strings.format(&quot;The protocol %s does not support the nonProxyHosts property.&quot;, getName())));</span>
	}

	/**
	 * Removes all given patterns from the current protocols {@code nonProxyHosts}
	 * property.
	 *
	 * &lt;p&gt;
	 * For protocols not supporting the {@code nonProxyHosts} property an
	 * {@link UnsupportedOperationException} is thrown.
	 *
	 * @param nonProxyHosts any number of hosts that should not be accessed
	 *                      &lt;b&gt;with&lt;/b&gt; going through the proxy
	 * @throws UnsupportedOperationException for protocols not supporting the
	 *                                       {@code nonProxyHosts} property
	 */
	public void removeNonProxyHosts(final String... nonProxyHosts) {
<span class="nc" id="L158">		final Set&lt;String&gt; set = getNonProxyHosts();</span>
<span class="nc" id="L159">		set.removeAll(asList(nonProxyHosts));</span>
<span class="nc" id="L160">		setNonProxyHosts(set);</span>
<span class="nc" id="L161">	}</span>

	/**
	 * Resets the current protocols {@code nonProxyHosts} property.
	 *
	 * &lt;p&gt;
	 * For protocols not supporting the {@code nonProxyHosts} property an
	 * {@link UnsupportedOperationException} is thrown.
	 *
	 * &lt;p&gt;
	 * Afterwards nothing but the default {@code nonProxyHosts} are set.
	 *
	 * @throws UnsupportedOperationException for protocols not supporting the
	 *                                       {@code nonProxyHosts} property
	 */
	public void resetNonProxyHosts() {
<span class="nc" id="L177">		setNonProxyHosts(getDefaultNonProxyHosts().orElseGet(Collections::emptyList));</span>
<span class="nc" id="L178">	}</span>

	/**
	 * Overwrites the JVM global current protocols proxy properties with the given
	 * host and port.
	 *
	 * @param inetSocketAddress host and port to apply globally
	 */
	public void setGlobalProxy(final InetSocketAddress inetSocketAddress) {
<span class="nc" id="L187">		System.setProperty(getHostProperty(), inetSocketAddress.getHostString());</span>
<span class="nc" id="L188">		System.setProperty(getPortProperty(), Integer.toString(inetSocketAddress.getPort()));</span>
<span class="nc" id="L189">	}</span>

	/**
	 * Overwrites the current protocols {@code nonProxyHosts} property with the
	 * given patterns.
	 *
	 * &lt;p&gt;
	 * For protocols not supporting the {@code nonProxyHosts} property an
	 * {@link UnsupportedOperationException} is thrown.
	 *
	 * @param nonProxyHosts any number of hosts that should be accessed
	 *                      &lt;b&gt;without&lt;/b&gt; going through the proxy
	 * @throws UnsupportedOperationException for protocols not supporting the
	 *                                       {@code nonProxyHosts} property
	 */
	public void setNonProxyHosts(final Collection&lt;String&gt; nonProxyHosts) {
<span class="nc" id="L205">		System.setProperty(getNonProxyHostsPropertyOrThrow(), String.join(&quot;|&quot;, nonProxyHosts));</span>
<span class="nc" id="L206">	}</span>

	/**
	 * Overwrites the JVM global current protocols proxy properties.
	 */
	public void unsetGlobalProxy() {
<span class="nc" id="L212">		System.clearProperty(getHostProperty());</span>
<span class="nc" id="L213">		System.clearProperty(getPortProperty());</span>
<span class="nc" id="L214">	}</span>

	/**
	 * Name
	 *
	 * @return name
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public String getName() {
		return this.name;
	}

	/**
	 * Proxy type
	 *
	 * @return proxy type
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public Type getType() {
		return this.type;
	}

	/**
	 * Default proxy port
	 *
	 * @return default proxy port
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public int getDefaultPort() {
		return this.defaultPort;
	}

	/**
	 * Host property name
	 *
	 * @return host property name
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public String getHostProperty() {
		return this.hostProperty;
	}

	/**
	 * Port property name
	 *
	 * @return port property name
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public String getPortProperty() {
		return this.portProperty;
	}

	/**
	 * {@code nonProxyHosts} property name
	 *
	 * @return {@code nonProxyHosts} property name
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public Optional&lt;String&gt; getNonProxyHostsProperty() {
		return this.nonProxyHostsProperty;
	}

	/**
	 * Default {@code nonProxyHosts}
	 *
	 * @return default {@code nonProxyHosts}
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public Optional&lt;Collection&lt;String&gt;&gt; getDefaultNonProxyHosts() {
		return this.defaultNonProxyHosts;
	}

	/**
	 * Creates a new {@code GlobalProxyConfiguration} instance.
	 *
	 * @param name Name
	 * @param type Proxy type
	 * @param defaultPort Default proxy port
	 * @param hostProperty Host property name
	 * @param portProperty Port property name
	 * @param nonProxyHostsProperty {@code nonProxyHosts} property name
	 * @param defaultNonProxyHosts Default {@code nonProxyHosts}
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	protected GlobalProxyConfiguration(final String name, final Type type, final int defaultPort, final String hostProperty, final String portProperty, final Optional&lt;String&gt; nonProxyHostsProperty, final Optional&lt;Collection&lt;String&gt;&gt; defaultNonProxyHosts) {
		this.name = name;
		this.type = type;
		this.defaultPort = defaultPort;
		this.hostProperty = hostProperty;
		this.portProperty = portProperty;
		this.nonProxyHostsProperty = nonProxyHostsProperty;
		this.defaultNonProxyHosts = defaultNonProxyHosts;
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>