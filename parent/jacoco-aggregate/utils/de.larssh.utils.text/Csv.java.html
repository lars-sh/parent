<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>Csv.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">Parent POM</a> &gt; <a href="../index.html" class="el_bundle">utils</a> &gt; <a href="index.source.html" class="el_package">de.larssh.utils.text</a> &gt; <span class="el_source">Csv.java</span></div><h1>Csv.java</h1><pre class="source lang-java linenums">// Generated by delombok at Wed Mar 05 08:40:23 UTC 2025
package de.larssh.utils.text;

import static java.util.Collections.emptyList;
import java.io.IOException;
import java.io.Reader;
import java.util.ArrayList;
import java.util.Collection;
import java.util.List;
import de.larssh.utils.Finals;
import de.larssh.utils.Nullables;
import de.larssh.utils.collection.ProxiedList;
import edu.umd.cs.findbugs.annotations.NonNull;
import edu.umd.cs.findbugs.annotations.Nullable;
import edu.umd.cs.findbugs.annotations.SuppressFBWarnings;

/**
 * This class represents CSV data, consisting of rows of values, implementing
 * {@code List&lt;String&gt;} for convenience reasons.
 *
 * &lt;p&gt;
 * The first row is referenced as &lt;i&gt;header&lt;/i&gt; row and {@link CsvRow} instances
 * allow to retrieve their values by the column's CSV header value.
 *
 * &lt;p&gt;
 * Instances of this class can be marked unmodifiable using
 * {@link #unmodifiable()}. Afterwards applying modifying actions on that
 * instance results in an {@link UnsupportedOperationException}.
 */
@SuppressWarnings(&quot;PMD.ShortClassName&quot;)
public class Csv extends ProxiedList&lt;CsvRow&gt; {
	/**
	 * The default CSV escape character
	 */
<span class="fc" id="L35">	public static final char DEFAULT_ESCAPER = Finals.constant('\&quot;');</span>
	/**
	 * The default CSV separator character
	 */
<span class="fc" id="L39">	public static final char DEFAULT_SEPARATOR = Finals.constant(',');</span>

	/**
	 * Parses the CSV data given by {@code reader}, starting at the current
	 * position.
	 *
	 * @param reader    a {@link Reader} as CSV data input
	 * @param separator the CSV separator character
	 * @param escaper   the CSV escaping character
	 * @return an object representing the parsed CSV data
	 * @throws IllegalArgumentException on illegal {@code separator} or
	 *                                  {@code escaper} value
	 * @throws IOException              if an I/O error occurs
	 */
	public static Csv parse(final Reader reader, final char separator, final char escaper) throws IOException {
<span class="nc" id="L54">		return new CsvParser(separator, escaper).parse(reader);</span>
	}

	/**
	 * The instances CSV separator character
	 */
	private final char separator;
	/**
	 * The instances CSV escape character
	 */
	private final char escaper;
	/**
	 * Flag specifying if this instance can be modified
	 *
	 * @param modifiable flag
	 */
<span class="nc" id="L70">	private boolean modifiable = true;</span>

	/**
	 * This class represents CSV data, consisting of rows of values, implementing
	 * {@code List&lt;String&gt;} for convenience reasons.
	 *
	 * &lt;p&gt;
	 * The first row is referenced as &lt;i&gt;header&lt;/i&gt; row and {@link CsvRow} instances
	 * allow to retrieve their values by the column's CSV header value.
	 */
	public Csv() {
<span class="nc" id="L81">		this(DEFAULT_SEPARATOR, DEFAULT_ESCAPER);</span>
<span class="nc" id="L82">	}</span>

	/**
	 * This class represents CSV data, consisting of rows of values, implementing
	 * {@code List&lt;String&gt;} for convenience reasons.
	 *
	 * &lt;p&gt;
	 * The first row is referenced as &lt;i&gt;header&lt;/i&gt; row and {@link CsvRow} instances
	 * allow to retrieve their values by the column's CSV header value.
	 *
	 * @param separator the instances CSV separator character
	 * @param escaper   the instances CSV escape character
	 */
	public Csv(final char separator, final char escaper) {
<span class="nc" id="L96">		super(new ArrayList&lt;&gt;());</span>
<span class="nc" id="L97">		this.separator = separator;</span>
<span class="nc" id="L98">		this.escaper = escaper;</span>
<span class="nc" id="L99">	}</span>

	/**
	 * This class represents CSV data, consisting of rows of values, implementing
	 * {@code List&lt;String&gt;} for convenience reasons.
	 *
	 * &lt;p&gt;
	 * The first row is referenced as &lt;i&gt;header&lt;/i&gt; row and {@link CsvRow} instances
	 * allow to retrieve their values by the column's CSV header value.
	 *
	 * @param initialCapacity an initial capacity of the internal list
	 * @throws IllegalArgumentException if the specified initial capacity is
	 *                                  negative
	 */
	public Csv(final int initialCapacity) {
<span class="nc" id="L114">		this(initialCapacity, DEFAULT_SEPARATOR, DEFAULT_ESCAPER);</span>
<span class="nc" id="L115">	}</span>

	/**
	 * This class represents CSV data, consisting of rows of values, implementing
	 * {@code List&lt;String&gt;} for convenience reasons.
	 *
	 * &lt;p&gt;
	 * The first row is referenced as &lt;i&gt;header&lt;/i&gt; row and {@link CsvRow} instances
	 * allow to retrieve their values by the column's CSV header value.
	 *
	 * @param initialCapacity an initial capacity of the internal list
	 * @param separator       the instances CSV separator character
	 * @param escaper         the instances CSV escape character
	 * @throws IllegalArgumentException if the specified initial capacity is
	 *                                  negative
	 */
	public Csv(final int initialCapacity, final char separator, final char escaper) {
<span class="nc" id="L132">		super(new ArrayList&lt;&gt;(initialCapacity));</span>
<span class="nc" id="L133">		this.separator = separator;</span>
<span class="nc" id="L134">		this.escaper = escaper;</span>
<span class="nc" id="L135">	}</span>

	/**
	 * This class represents CSV data, consisting of rows of values, implementing
	 * {@code List&lt;String&gt;} for convenience reasons.
	 *
	 * &lt;p&gt;
	 * The first row is referenced as &lt;i&gt;header&lt;/i&gt; row and {@link CsvRow} instances
	 * allow to retrieve their values by the column's CSV header value.
	 *
	 * @param data a collection containing CSV rows to be added
	 */
	public Csv(final List&lt;? extends List&lt;String&gt;&gt; data) {
<span class="nc" id="L148">		this(data, DEFAULT_SEPARATOR, DEFAULT_ESCAPER);</span>
<span class="nc" id="L149">	}</span>

	/**
	 * This class represents CSV data, consisting of rows of values, implementing
	 * {@code List&lt;String&gt;} for convenience reasons.
	 *
	 * &lt;p&gt;
	 * The first row is referenced as &lt;i&gt;header&lt;/i&gt; row and {@link CsvRow} instances
	 * allow to retrieve their values by the column's CSV header value.
	 *
	 * @param data      a collection containing CSV rows to be added
	 * @param separator the instances CSV separator character
	 * @param escaper   the instances CSV escape character
	 */
	@SuppressWarnings(&quot;PMD.AvoidInstantiatingObjectsInLoops&quot;)
	@SuppressFBWarnings(value = &quot;PCOA_PARTIALLY_CONSTRUCTED_OBJECT_ACCESS&quot;, justification = &quot;passing this object to CsvRow constructor shouldn\'t be a problem&quot;)
	public Csv(final List&lt;? extends List&lt;String&gt;&gt; data, final char separator, final char escaper) {
<span class="nc" id="L166">		this(data.size(), separator, escaper);</span>
<span class="nc bnc" id="L167" title="All 2 branches missed.">		for (final List&lt;String&gt; row : Nullables.orElseThrow(data)) {</span>
<span class="nc" id="L168">			super.add(new CsvRow(this, super.size(), Nullables.orElseThrow(row)));</span>
<span class="nc" id="L169">		}</span>
<span class="nc" id="L170">	}</span>

	/**
	 * {@inheritDoc}
	 */
	@Override
	public boolean add(@Nullable final CsvRow element) {
<span class="nc" id="L177">		return add((List&lt;String&gt;) Nullables.orElseThrow(element));</span>
	}

	/**
	 * Adds the specified CSV row to the this CSV object.
	 *
	 * @param element the CSV row to be added
	 * @return {@code true}
	 * @throws UnsupportedOperationException if this CSV object is unmodifiable
	 */
	public boolean add(final List&lt;String&gt; element) {
<span class="nc" id="L188">		return super.add(new CsvRow(this, size(), element));</span>
	}

	/**
	 * {@inheritDoc}
	 */
	@Override
	@SuppressWarnings(&quot;unused&quot;)
	public void add(final int index, @Nullable final CsvRow element) {
<span class="nc" id="L197">		throw new UnsupportedOperationException();</span>
	}

	/**
	 * {@inheritDoc}
	 */
	@Override
	public boolean addAll(@Nullable final Collection&lt;? extends CsvRow&gt; collection) {
<span class="nc" id="L205">		return addAllList(Nullables.orElseThrow(collection));</span>
	}

	/**
	 * {@inheritDoc}
	 */
	@Override
	@SuppressWarnings(&quot;unused&quot;)
	public boolean addAll(final int index, @Nullable final Collection&lt;? extends CsvRow&gt; collection) {
<span class="nc" id="L214">		throw new UnsupportedOperationException();</span>
	}

	/**
	 * Adds all of the CSV rows in {@code collection} to this CSV object.
	 *
	 * &lt;p&gt;
	 * The behavior of this operation is undefined if the specified collection is
	 * modified while the operation is in progress. (This implies, that the behavior
	 * of this call is undefined if the specified collection is this CSV object, and
	 * this CSV object is non-empty.)
	 *
	 * @param collection the collection containing CSV rows to be added
	 * @return {@code true} if this CSV object changed as a result of the call, else
	 *         {@code false}
	 * @throws UnsupportedOperationException if this CSV object is unmodifiable
	 */
	public boolean addAllList(final Collection&lt;? extends List&lt;String&gt;&gt; collection) {
<span class="nc" id="L232">		boolean modified = false;</span>
<span class="nc bnc" id="L233" title="All 2 branches missed.">		for (final List&lt;String&gt; row : collection) {</span>
<span class="nc" id="L234">			modified |= add(row);</span>
<span class="nc" id="L235">		}</span>
<span class="nc" id="L236">		return modified;</span>
	}

	/**
	 * {@inheritDoc}
	 */
	@NonNull
	@Override
	public CsvRow get(final int index) {
<span class="nc" id="L245">		return getWrappedForRead().get(index);</span>
	}

	/**
	 * Returns the headers of this CSV object. Headers are specified by the first
	 * row. If this CSV object is empty, an empty list is returned.
	 *
	 * @return the headers of this CSV object
	 */
	public List&lt;String&gt; getHeaders() {
<span class="nc bnc" id="L255" title="All 2 branches missed.">		return isEmpty() ? emptyList() : get(0);</span>
	}

	/**
	 * {@inheritDoc}
	 */
	@NonNull
	@Override
	public CsvRow remove(final int index) {
<span class="nc bnc" id="L264" title="All 2 branches missed.">		if (index == size() - 1) {</span>
<span class="nc" id="L265">			return Nullables.orElseThrow(super.remove(index));</span>
		}
<span class="nc" id="L267">		throw new UnsupportedOperationException();</span>
	}

	/**
	 * {@inheritDoc}
	 */
	@NonNull
	@Override
	public CsvRow set(final int index, @Nullable final CsvRow element) {
<span class="nc" id="L276">		return getWrappedIfModifiable().set(index, new CsvRow(this, index, Nullables.orElseThrow(element)));</span>
	}

	/**
	 * Returns a valid CSV string representation of this object using the instances
	 * separator and escaper.
	 *
	 * @return a valid CSV representation of this object using the instances
	 *         separator and escaper
	 */
	@Override
	public String toString() {
<span class="nc" id="L288">		return toString(getSeparator(), getEscaper());</span>
	}

	/**
	 * Returns a valid CSV string representation of this object using
	 * {@code separator} and {@code escaper}.
	 *
	 * &lt;p&gt;
	 * This is a short-hand method for
	 * {@link StringConverters#encodeCsv(Collection, char, char)}.
	 *
	 * @param separator the CSV separator
	 * @param escaper   the CSV value escaper
	 * @return a valid CSV representation of this object using {@code separator} and
	 *         {@code escaper}
	 */
	public String toString(final char separator, final char escaper) {
<span class="nc" id="L305">		return StringConverters.encodeCsv(this, separator, escaper);</span>
	}

	/**
	 * Marks the CSV object as unmodifiable
	 *
	 * @return this objects
	 */
	public Csv unmodifiable() {
<span class="nc" id="L314">		modifiable = false;</span>
<span class="nc" id="L315">		return this;</span>
	}

	/**
	 * The instances CSV separator character
	 *
	 * @return the CSV separator character
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public char getSeparator() {
		return this.separator;
	}

	/**
	 * The instances CSV escape character
	 *
	 * @return the CSV escape character
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public char getEscaper() {
		return this.escaper;
	}

	/**
	 * Flag specifying if this instance can be modified
	 *
	 * @return {@code true} if this instance is modifiable, else {@code false}
	 */
	@java.lang.SuppressWarnings(&quot;all&quot;)
	@edu.umd.cs.findbugs.annotations.SuppressFBWarnings(justification = &quot;generated code&quot;)
	@lombok.Generated
	public boolean isModifiable() {
		return this.modifiable;
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>